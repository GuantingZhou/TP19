!function(){"use strict";const b=(a,d,g)=>{var o,v,p,q,r,s,t,u,h,m,l,k,j,w;const e=null==a?void 0:a.id,b={},{formFieldsData:i,elemsWithError:z}=(a=>{var b,c,d;const e=[],f=[{label:(null===(b=window)||void 0===b||null===(c=b.themeisleGutenbergForm)||void 0===c?void 0:c.messages["form-submission"])||"Form submission from",value:window.location.href}];return null===(d=[...null==a?void 0:a.querySelectorAll(".otter-form__container .wp-block-themeisle-blocks-form-input"),...null==a?void 0:a.querySelectorAll(".otter-form__container .wp-block-themeisle-blocks-form-textarea")])||void 0===d||d.forEach(b=>{var c,d;const g=null===(c=b.querySelector(".otter-form-input-label__label, .otter-form-textarea-label__label"))||void 0===c?void 0:c.innerHTML,a=b.querySelector(".otter-form-input, .otter-form-textarea-input"),h=null===(d=b.querySelector('.otter-form-input[type="checkbox"]'))||void 0===d?void 0:d.checked;null==a||!a.hasAttribute("required")||null!=a&&a.checkValidity()||e.push(a),g&&null!=a&&a.value&&f.push({label:g,value:null==a?void 0:a.value,type:null==a?void 0:a.type,checked:h})}),{formFieldsData:f,elemsWithError:e}})(a),A=2>(null==i?void 0:i.length),y=function(b){var a;const c=`.protection #${b.id||""}_nonce_field`;return null===(a=b.querySelector(c))||void 0===a?void 0:a.value}(a),x=null==a||null===(o=a.classList)||void 0===o?void 0:o.contains("has-captcha"),n=e&&(null===(v=window.themeisleGutenberg)||void 0===v?void 0:v.tokens[e].token),f=document.createElement("span");if(f.classList.add("spinner"),d.appendChild(f),A)return d.disabled=!1,void d.removeChild(f);if(z.forEach(a=>{null==a||a.reportValidity()}),x&&!n){const a=window.hasOwnProperty("grecaptcha")?"check-captcha":"captcha-not-loaded";g.pullMsg(a,"error").show()}if(0<z.length||x&&!n)d.disabled=!1,d.removeChild(f);else{b.formInputsData=i,n&&(b.token=null===(m=window.themeisleGutenberg)||void 0===m||null===(l=m.tokens)||void 0===l?void 0:l[e].token),""!==(null==a||null===(p=a.dataset)||void 0===p?void 0:p.emailSubject)&&(b.emailSubject=null==a||null===(k=a.dataset)||void 0===k?void 0:k.emailSubject),null!=a&&null!==(q=a.dataset)&&void 0!==q&&q.optionName&&(b.formOption=null==a||null===(j=a.dataset)||void 0===j?void 0:j.optionName),null!=a&&a.id&&(b.formId=null==a?void 0:a.id),y&&(b.nonceValue=y),b.postUrl=window.location.href,a.classList.contains("can-submit-and-subscribe")&&(b.action="submit-subscribe",b.consent=(null===(w=a.querySelector(".otter-form-consent input"))||void 0===w?void 0:w.checked)||!1);const o=((null===(r=window)||void 0===r||null===(s=r.themeisleGutenbergForm)||void 0===s?void 0:s.root)||window.location.origin+"/wp-json/")+"otter/v1/form/frontend";null===(t=fetch(o,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, */*;q=0.1","X-WP-Nonce":null===(u=window)||void 0===u||null===(h=u.themeisleGutenbergForm)||void 0===h?void 0:h.nonce},credentials:"include",body:JSON.stringify({handler:"submit",payload:b})}).then(a=>a.json()).then(p=>{var i,j,k,l,h,m,n,o;const b=p;if(null!=b&&b.success){const d=null!=b&&b.submitMessage?b.submitMessage:"Success";g.setMsg(d).show(),c(a),setTimeout(()=>{var a;if(0<(null==b||null===(a=b.redirectLink)||void 0===a?void 0:a.length)){let a=document.createElement("a");a.target="_blank",a.href=b.redirectLink,a.click()}},1e3)}else{let a="";a=null!=b&&b.provider&&null!=b&&null!==(k=b.error)&&void 0!==k&&k.includes("invalid")||null!=b&&null!==(l=b.error)&&void 0!==l&&l.includes("fake")?"invalid-email":null!=b&&b.provider&&null!=b&&null!==(h=b.error)&&void 0!==h&&h.includes("duplicate")||null!=b&&null!==(m=b.error)&&void 0!==m&&m.includes("already")?"already-registered":"try-again",g.pullMsg(a,"error").show(),console.error(null==b?void 0:b.error,null==b?void 0:b.reasons)}null!==(i=window.themeisleGutenberg)&&void 0!==i&&null!==(j=i.tokens)&&void 0!==j&&j[e].reset&&(null===(n=window.themeisleGutenberg)||void 0===n||null===(o=n.tokens)||void 0===o||o[e].reset()),d.disabled=!1,d.removeChild(f)}))||void 0===t||t.catch(i=>{var a,b,c,h;console.error(i),g.pullMsg("try-again","error").show(),null!==(a=window.themeisleGutenberg)&&void 0!==a&&null!==(b=a.tokens)&&void 0!==b&&b[e].reset&&(null===(c=window.themeisleGutenberg)||void 0===c||null===(h=c.tokens)||void 0===h||h[e].reset()),d.disabled=!1,d.removeChild(f)})}},c=a=>{var b;null===(b=[...null==a?void 0:a.querySelectorAll(".otter-form__container .wp-block-themeisle-blocks-form-input"),...null==a?void 0:a.querySelectorAll(".otter-form__container .wp-block-themeisle-blocks-form-textarea")])||void 0===b||b.forEach(b=>{const a=b.querySelector(".otter-form-input, .otter-form-textarea-input");null!=a&&a.value&&(a.value=null)})};var a;a=()=>{const a=document.querySelectorAll(".wp-block-themeisle-blocks-form");(c=>{var a,b;if(!window.hasOwnProperty("grecaptcha")&&null!==(a=window)&&void 0!==a&&null!==(b=a.themeisleGutenbergForm)&&void 0!==b&&b.reRecaptchaSitekey){const a=document.createElement("script");a.id="recaptcha",document.body.appendChild(a),a.addEventListener("load",()=>{const a=setInterval(()=>{window.hasOwnProperty("grecaptcha")&&window.grecaptcha.hasOwnProperty("render")&&(c.forEach(a=>{var b;null!=a&&null!==(b=a.classList)&&void 0!==b&&b.contains("has-captcha")&&(g=>{var b,c,d;if(!window.hasOwnProperty("grecaptcha"))return;const{id:e}=g,f=document.createElement("div"),a=g.querySelector(".otter-form__container");null==a||a.insertBefore(f,a.lastChild);const h=null===(b=window.grecaptcha)||void 0===b?void 0:b.render(f,{sitekey:null===(c=window)||void 0===c||null===(d=c.themeisleGutenbergForm)||void 0===d?void 0:d.reRecaptchaSitekey,callback:b=>{var a;null!==(a=window.themeisleGutenberg)&&void 0!==a&&a.tokens||(window.themeisleGutenberg={},window.themeisleGutenberg.tokens={}),window.themeisleGutenberg.tokens[e]={token:b,reset:()=>{var a;return null===(a=window.grecaptcha)||void 0===a?void 0:a.reset(h)}}},"expired-callback":()=>{var a;null!==(a=window.themeisleGutenberg)&&void 0!==a&&a.tokens||(window.themeisleGutenberg={},window.themeisleGutenberg.tokens={}),window.themeisleGutenberg.tokens[e]={token:null,reset:()=>null}}})})(a)}),clearInterval(a))},200)}),a.src="https://www.google.com/recaptcha/api.js"}})(a),a.forEach(a=>{a.classList.contains("can-submit-and-subscribe")&&(g=>{var e,c,d;const h=g.querySelector(".otter-form__container"),i=g.querySelector(".wp-block-button"),a=document.createElement("div");a.classList.add("otter-form-consent"),h.insertBefore(a,i);const b=document.createElement("input");b.type="checkbox",b.name="o-consent",b.id="o-consent";const f=document.createElement("label");f.innerHTML=(null===(e=window)||void 0===e||null===(c=e.themeisleGutenbergForm)||void 0===c||null===(d=c.messages)||void 0===d?void 0:d.privacy)||"I have read and agreed the privacy statement.",f.htmlFor="o-consent",a.appendChild(b),a.appendChild(f)})(a);const c=a.querySelector("button"),d=new class{constructor(b){var a;this.form=b,this.anchor=b.querySelector(".wp-block-button"),null===(a=this.anchor)||void 0===a||a.classList.add("has-submit-msg"),this.msgElem=document.createElement("div"),this.msgElem.classList.add("o-form-server-response"),this.anchor.appendChild(this.msgElem),this.isVisible=!1,this.visibilityTimeout=void 0,this.visibilityDuration=12e3}toggle(a){this.isVisible=void 0!==a?a:!this.isVisible,this.msgElem.style.display=this.isVisible?"block":"none"}pullMsg(c,d){var a,b;return this.setMsg((null===(a=window)||void 0===a||null===(b=a.themeisleGutenbergForm)||void 0===b?void 0:b.messages[c])||"Messages are missing!",d)}setMsg(a){let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";switch(this.msgElem.innerHTML=a,this.clean(),b){case"error":this.msgElem.classList.toggle("o-error",!0);break;case"warning":this.msgElem.classList.toggle("o-warning",!0);break;default:this.msgElem.classList.toggle("o-success",!0)}return this}show(a){clearTimeout(this.visibilityTimeout),this.toggle(!0),this.visibilityTimeout=setTimeout(()=>{this.toggle(!1)},a||this.visibilityDuration)}clean(){this.msgElem.classList.toggle("o-error",!1),this.msgElem.classList.toggle("o-warning",!1),this.msgElem.classList.toggle("o-success",!1)}}(a);a.querySelector('button[type="submit"]')?null==a||a.addEventListener("submit",e=>{e.preventDefault(),c.disabled||(c.disabled=!0,b(a,c,d))},!1):null==c||c.addEventListener("click",e=>{e.preventDefault(),c.disabled||(c.disabled=!0,b(a,c,d))},!1)})},"undefined"!=typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",a):a())}()